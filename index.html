<!DOCTYPE html>
<html lang="en">
  <head>
	<meta charset="UTF-8">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:wght@300;400&display=swap" rel="stylesheet">
		<link href="https://cdn.jsdelivr.net/npm/material-icons@1.13.14/iconfont/material-icons.min.css" rel="stylesheet">
		<link rel="stylesheet" href="styles.css">
		<script src="./react.js"></script>
		<script src="./react-dom.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/axios@1.10.0/dist/axios.min.js"></script>
		<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
		<title>Weather App</title>
  </head>
  <body>
    <div>
		<div id="root">
    </div>
	<script type="text/babel">
		/*
		Condition-Sun -> Condition Function - that does only one thing. where to write? inside the fetch-request?
		Condition -> Conditional-Statement ->

		"Very often when you write code, you want to perform different actions for different decisions."

		Read about conditions in react -> conditional-statements -> conditional-rendering - way to go!

		*/
		// MAIN
		function App(){
			// IMPORT
			const { useState, useEffect } = React;
			// INVISIBLE
			const [long, setLong] = useState(null);
			const [lat, setLat] = useState(null);
			// VISIBLE
			const [temp, setTemp] = useState(null);
			const [spd, setSpd] = useState(null);
      const [cld, setCld] = useState(null);
			const [min, setMin] = useState(null);
			const [max, setMax] = useState(null);
			const [wkDay, setWkDay] = useState(null);
			const [sun, setSun] = useState(null);
			const [light, setLight] = useState(null);
			const [condition, setCondition] = useState(null);
      const [snow, setSnow] = useState(null);
      const [rn, setRn] = useState(null);
      const [shwr, setShwr] = useState(null);
			// URL
			const APIurl = "https://api.open-meteo.com/v1/forecast?latitude=48.30&longitude=14.28&daily=weather_code,apparent_temperature_max,apparent_temperature_min,sunshine_duration,daylight_duration&current=apparent_temperature,snowfall,cloud_cover,precipitation,rain,showers,wind_speed_10m,wind_direction_10m&timezone=Europe%2FBerlin&forecast_days=1";
      
			// TIME
			let timer = new Date();
			let hours = timer.getHours();
			let minutes = timer.getMinutes();
			let days = timer.getDay();
			let dayInDig = days;

			// WEEKDAY
			const currday = (dayInDig) => {
			    if(dayInDig === 1){
			      return "Mo";
			    }
			    else if(dayInDig === 2){
			      return "Di";
			    }
			    else if(dayInDig === 3){
			      return "Mi";
			    }
			    else if(dayInDig === 4){
			      return "Do";
			    }
			    else if(dayInDig === 5){
			      return "Fr";
			    }
			    else if(dayInDig === 6){
			      return "Sa";
			    }
			    else{
			      return "So";
			    }
			  }
			let weekDay = currday(dayInDig);
			let conHours = hours.toString();
			let conMinutes = minutes.toString();
			let currentTime = " " + conHours + ":" +  conMinutes + " Uhr";
			// API
			useEffect(()=>{
				axios.get(APIurl)
					.then(response => {
            // DATA
						let responses = response.data.current;
						let responsesTwo = response.data;
            console.log(responses);
            // VARS
						let lightDur = ((responsesTwo.daily.daylight_duration /60) / 60);
						let sunDur = ((responsesTwo.daily.sunshine_duration / 60) / 60);
						let lightStr = lightDur.toString()
						let lightSlice = lightStr.slice(0, 2);
						let sunStr = sunDur.toString();
						let sunSlice = sunStr.slice(0, 2);
            let cloudCover = responses.cloud_cover;
            let rainShower = responses.shower;
            let rain = responses.rain;
            let snow = responses.snowfall;
						// TEMP
						setTemp(responses.apparent_temperature);
						setSpd(responses.wind_speed_10m);
						setWkDay(weekDay);
						setMax(responsesTwo.daily.apparent_temperature_max);
						setMin(responsesTwo.daily.apparent_temperature_min);
						setLight(lightSlice);
						setSun(sunSlice);
            setCld(cloudCover);
            setRn(rain);
            setShwr(rainShower);
            setSnow(snow);
					})
			}, [])
      // Condition Setting
      /*
      Sunny = little cloud, little precipitation
      -> Put clouds, and precipitation into api-call
      Windy = High wind speeds
      Rainy = Rain High or Showers High
      Snow = Snow High
      Storm = Storm High
      */
      useEffect(() => {
        if(temp > 15 && cld < 40){
          setCondition("Clear Sky")
        }
        else if(cld > 40){
          setCondition("Cloudy")
        }
        else if(rn > 0){
          setCondition("Rain")
        }
        else if (shwr > 1 && rn > 0){
          setCondition("Shower")
        }
        else if (snow > 0) {
          setCondition("Snow")
        }
        }
      )
return (
<div className="wrapper">
      <div className="header">
				<p className="time">{wkDay}, {currentTime}</p>
		<h4 className="location-Header">Standort</h4>
		<h2 className="city">Linz</h2>
		<p className="temperature">{temp}°</p>
		<div className="condis">
				<h3>{condition}</h3>
		</div>
</div>
		<div className="weather-details">
        <div>
          <p>Wind Speed:</p>
          <p className="detail">{spd} km/h</p>
        </div>
        <div className="averages">
				<p>Min: {min}°</p>
				<p>Max: {max}°</p>
		</div>
		<div className="lightSun">
				<p>Sonnenstrahlen-Dauer (Stunden): {sun}</p>
				<p>Tageslicht-Dauer (Stunden): {light}</p>
		</div>
		</div>
      <div className="forecast">
        <h2 className="headForecast">5-Day Forecast</h2>
        <div className="forecast-days">
          <div className="forecast-day">
            <p className="dayName">Monday</p>
            <p>Cloudy</p>
            <p>12°F</p>
          </div>
          <div className="forecast-day">
            <p className="dayName">Tuesday</p>
            <p>Cloudy</p>
            <p>12°F</p>
          </div>
          <div className="forecast-day">
            <p className="dayName">Wednesday</p>
            <p>Cloudy</p>
            <p>12°F</p>
          </div>
          <div className="forecast-day">
            <p className="dayName">Thursday</p>
            <p>Cloudy</p>
            <p>12°F</p>
          </div>
          <div className="forecast-day">
            <p className="dayName">Friday</p>
            <p>Cloudy</p>
            <p>12°F</p>
          </div>
          <div className="forecast-day">
            <p className="dayName">Saturday</p>
            <p>Cloudy</p>
            <p>12°F</p>
          </div>
          <div className="forecast-day">
            <p className="dayName">Sunday</p>
            <p>Cloudy</p>
            <p>12°F</p>
          </div>
        </div>
      </div>
    </div>
			)
		}
		// RENDERING
		const root= ReactDOM.createRoot(document.getElementById('root'));
		root.render(<App />)
	</script>
  </body>
</html>
